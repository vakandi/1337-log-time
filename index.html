<html>
  <head>
    <style>
      /* Add styles to center the elements on the page */
      .center {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      /* Add styles to make the output text colorful */
      p {
        color: blue;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="center">
      <div>
        <input type="text" id="input" placeholder="Enter login">
        <button onclick="executeScript()">Execute</button>
        <div id="output"></div>
      </div>
    </div>

    <script>
      function executeScript() {
        var UID = "5f098420ac985c69454de207c0ed775aa09f12c7e1e2dc7d7070dd6ec27d49da";
        var SECRET = "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";
        var login = document.querySelector("#input").value;
        var d = new Date();
        var prev_month = new Date(d.getFullYear(), d.getMonth() - 1, 28);
        var begin_at = prev_month.toISOString().slice(0, 10);

        fetch("https://api.intra.42.fr/v2/users/" + login + "/locations_stats?begin_at=" + begin_at, {
          method: "GET",
          headers: {
            "Authorization": "Bearer " + btoa(UID + ":" + SECRET)
          }
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            var daily_hours = {};
            for (var date in data) {
              var time_string = data[date];
              var hours = parseInt(time_string.split(':')[0]);
              var minutes = parseInt(time_string.split(':')[1]);
              var seconds = parseInt(time_string.split(':')[2]);
              daily_hours[date] = hours + (minutes / 60) + (seconds / 3600);
            }

            var total_hours = 0;
            for (var date in daily_hours) {
              total_hours += daily_hours[date];
            }

            document.querySelector("#output").innerHTML = "";
            document.querySelector("#output").innerHTML += `<p>Total hours: ${Math.floor(total_hours)} h</p>`;
          })
          .catch(function (error) {
            console.log(error);
            document.querySelector("#output").innerHTML = "An error occurred. Please check the console for more information.";
          });
      }
    </script>
 
</html>
